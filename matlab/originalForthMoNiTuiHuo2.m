tic
clear all;
close all;
clc;
MM=[];
GGoal=[];

% % L=[58021.555 47;58188.973 15;58438.129 29;58198.211 57;58139.844 52;58130.465 40;58224.496 20;58210.168 44;58008.453 45;58201.094 65;58151.910 12;58088.086 32;58245.402 50;58153.391 67;...
% %    58309.773 33;57871.414 9;58140.707 30;57811.164 42;58446.582 11;58526.051 13;58034.395 60;58022.969 18;58467.906 8;57427.840 59;58113.273 23;58020.020 31;58064.785 28;58328.859 6;...
% %    58158.246 41;58165.406 55;57683.879 66;58033.598 19;58147.195 49;58269.109 24;58137.215 1;58146.219 56;58490.207 5;58285.211 43;58373.438 38;57637.551 39;58130.953 46;58334.555 70;...
% %    58334.188 22;58211.605 26;58104.137 4;57979.859 36;58101.453 25;57959.086 3;58108.949 69;58065.789 17;58145.563 61;58012.012 37;58358.555 7;58045.586 63;58227.848 21;57842.711 51;...
% %    58148.449 54;58487.664 35;58519.691 2;57871.137 10;58167.398 34;58023.844 53;57908.699 62;57956.043 16;58291.840 27;58421.148 58;57879.496 48;57877.262 64;57843.551 68;58268.633 14];
L=[58021.555 47;58188.973 15;58438.129 29;58198.211 57;58139.844 52;58130.465 40;58224.496 20;58210.168 44;58008.453 45;58201.094 65;58151.910 12;...
    58088.086 32;58245.402 50;58153.391 67;58309.773 33;57871.414 9;58140.707 30;57811.164 42;58446.582 11;58526.051 13;58034.395 60;58022.969 18;...
    58467.906 8;57427.840 59;58113.273 23;58020.020 31;58064.785 28;58328.859 6;58158.246 41;58165.406 55;57683.879 66;58033.598 19;58147.195 49;...
    58269.109 24;58137.215 1;58146.219 56;58490.207 5;58285.211 43;58373.438 38;57637.551 39;58130.953 46;58334.555 70;58334.188 22;58211.605 26;...
    58104.137 4;57979.859 36;58101.453 25;57959.086 3;58108.949 69;58065.789 17;58145.563 61;58012.012 37;58358.555 7;58045.586 63;58227.848 21;...
    57842.711 51;58148.449 54;58487.664 35;58519.691 2;57871.137 10;58167.398 34;58023.844 53;57908.699 62;57956.043 16;58291.840 27;58421.148 58;...
    57879.496 48;57877.262 64;57843.551 68;58268.633 14];
t=0.0001;
A=0.99;
K=200;
iteration=0;
sita=[];
goal_y=0;
goal_x=0;
[h,lie]=size(L);
T=100*h;
for i=1:h
    m=i*(2*pi)/h;
    sita=[sita,m];
    goal_y=goal_y+sin(m)*L(i,1);
    goal_x=goal_x+cos(m)*L(i,1);
end
goal=sqrt(goal_y^2+goal_x^2);
GG=[];
while T>t 
% %     %%分段降温%%
% %     if T>=50
% %         A=0.8;
% %     else
% %         if T>10
% %             A=0.9;
% %         else
% %             A=0.99;
% %         end
% %     end
    T=T*A;
    iteration=iteration+1;  
    for i=1:K             
        M=L;
% %         temp_1= unidrnd(h);
% %         temp_2= unidrnd(h);
        temp_1= floor(1+h*rand());
        temp_2= floor(1+h*rand());
        number_1_h=L(temp_1,1);
        number_1_lie=L(temp_1,2);
        number_2_h=L(temp_2,1);
        number_2_lie=L(temp_2,2);
        M(temp_1,1)=number_2_h;
        M(temp_1,2)=number_2_lie;
        M(temp_2,1)=number_1_h;
        M(temp_2,2)=number_1_lie;
        goal_y_new=0;
        goal_x_new=0;    
        for ii = 1:h
            goal_y_new=goal_y_new+sin(sita(1,ii))*M(ii,1);
            goal_x_new=goal_x_new+cos(sita(1,ii)*M(ii,1));  
        end
        goal_new=sqrt(goal_x_new^2+goal_y_new^2);
        detaT=goal_new-goal;
        if detaT<0
            L=M;
            goal=goal_new;
        else
            yita=rand(1);
            if  yita<exp(-detaT/T)
                L=M;
                goal=goal_new;
            end
        end        
    end
    GG=[GG,goal];
end
x=1:iteration;
% % subplot(1,2,1);
% % plot(x,GG)
% % grid on 
% % xlabel("迭代次数")
% % ylabel("目标值")
% % title("适应度进化曲线")
% % disp("目标函数值为:")
% % goal
% % disp("迭代次数:")
% % iteration
% % disp("优化排序为:")
% % L
% % subplot(1,2,2);
MRayforth(L)
% MM=[MM,L];
% GGoal=[GGoal,goal];
%
% plot(GGoal)
% ll=GGoal'
toc
disp(['运行时间: ',num2str(toc)]);




        
        
    
    